"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[509],{3905:(e,o,a)=>{a.d(o,{Zo:()=>l,kt:()=>g});var n=a(7294);function r(e,o,a){return o in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a,e}function t(e,o){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var o=1;o<arguments.length;o++){var a=null!=arguments[o]?arguments[o]:{};o%2?t(Object(a),!0).forEach((function(o){r(e,o,a[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(a,o))}))}return e}function i(e,o){if(null==e)return{};var a,n,r=function(e,o){if(null==e)return{};var a,n,r={},t=Object.keys(e);for(n=0;n<t.length;n++)a=t[n],o.indexOf(a)>=0||(r[a]=e[a]);return r}(e,o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(n=0;n<t.length;n++)a=t[n],o.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),m=function(e){var o=n.useContext(d),a=o;return e&&(a="function"==typeof e?e(o):s(s({},o),e)),a},l=function(e){var o=m(e.components);return n.createElement(d.Provider,{value:o},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var o=e.children;return n.createElement(n.Fragment,{},o)}},p=n.forwardRef((function(e,o){var a=e.components,r=e.mdxType,t=e.originalType,d=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),u=m(a),p=r,g=u["".concat(d,".").concat(p)]||u[p]||c[p]||t;return a?n.createElement(g,s(s({ref:o},l),{},{components:a})):n.createElement(g,s({ref:o},l))}));function g(e,o){var a=arguments,r=o&&o.mdxType;if("string"==typeof e||r){var t=a.length,s=new Array(t);s[0]=p;var i={};for(var d in o)hasOwnProperty.call(o,d)&&(i[d]=o[d]);i.originalType=e,i[u]="string"==typeof e?e:r,s[1]=i;for(var m=2;m<t;m++)s[m]=a[m];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},4470:(e,o,a)=>{a.r(o),a.d(o,{assets:()=>d,contentTitle:()=>s,default:()=>c,frontMatter:()=>t,metadata:()=>i,toc:()=>m});var n=a(7462),r=(a(7294),a(3905));const t={},s="Primeiros passos com o MongoDB",i={unversionedId:"burger-queen-api/guides/GETTING-STARTED-MONGODB",id:"burger-queen-api/guides/GETTING-STARTED-MONGODB",title:"Primeiros passos com o MongoDB",description:"O MongoDB \xe9 um banco de dados n\xe3o relacional e \xe9 o mais comum (popular)",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/04-burger-queen-api/guides/GETTING-STARTED-MONGODB.md",sourceDirName:"04-burger-queen-api/guides",slug:"/burger-queen-api/guides/GETTING-STARTED-MONGODB",permalink:"/bootcamp/pt/docs/burger-queen-api/guides/GETTING-STARTED-MONGODB",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/04-burger-queen-api/guides/GETTING-STARTED-MONGODB.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Primeiros passos",permalink:"/bootcamp/pt/docs/burger-queen-api/guides/GETTING-STARTED-DOCKER"}},d={},m=[{value:"1. Instalar o MongoDB e o Compass",id:"1-instalar-o-mongodb-e-o-compass",level:2},{value:"2. Iniciar o banco de dados e o servidor",id:"2-iniciar-o-banco-de-dados-e-o-servidor",level:2},{value:"3. Escolher um m\xf3dulo (cliente)",id:"3-escolher-um-m\xf3dulo-cliente",level:2},{value:"Exemplo de conex\xe3o usando o driver do MongoDB para Node.js",id:"exemplo-de-conex\xe3o-usando-o-driver-do-mongodb-para-nodejs",level:3},{value:"4. Definir esquemas",id:"4-definir-esquemas",level:2},{value:"5. Implementar os primeiros TODOs",id:"5-implementar-os-primeiros-todos",level:2},{value:"TODO 1: Conectar a la base de datos",id:"todo-1-conectar-a-la-base-de-datos",level:3},{value:"TODO 2: Criar o usu\xe1rio <em>admin</em>",id:"todo-2-criar-o-usu\xe1rio-admin",level:3},{value:"TODO 3: Implementar autenticaci\xf3n de usuario",id:"todo-3-implementar-autenticaci\xf3n-de-usuario",level:3},{value:"TODO 4: Implementar o middleware de autentica\xe7\xe3o",id:"todo-4-implementar-o-middleware-de-autentica\xe7\xe3o",level:3},{value:"TODO 5: Implementar a rota GET <code>/users</code>",id:"todo-5-implementar-a-rota-get-users",level:3},{value:"6. Definir estrat\xe9gia de testes unit\xe1rios",id:"6-definir-estrat\xe9gia-de-testes-unit\xe1rios",level:2},{value:"7. Familiarizar-se com os testes de integra\xe7\xe3o (e2e)",id:"7-familiarizar-se-com-os-testes-de-integra\xe7\xe3o-e2e",level:2}],l={toc:m},u="wrapper";function c(e){let{components:o,...a}=e;return(0,r.kt)(u,(0,n.Z)({},l,a,{components:o,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"primeiros-passos-com-o-mongodb"},"Primeiros passos com o MongoDB"),(0,r.kt)("p",null,"O MongoDB \xe9 um banco de dados n\xe3o relacional e \xe9 o mais comum (popular)\natualmente no ecossistema Node.js."),(0,r.kt)("p",null,'Se voc\xea estiver trabalhando com o MongoDB e Docker, \xe9 melhor ler primeiro\no guia "Primeiros passos com o Docker". Se voc\xea estiver instalando o MongoDB\ne desenvolvendo o projeto sem o Docker neste momento, continue lendo este guia.'),(0,r.kt)("p",null,"Depois de criar o seu fork e clonar o reposit\xf3rio em seu computador,\nexecute o comando npm install para instalar as depend\xeancias b\xe1sicas.\nAntes de come\xe7ar a codificar, precisamos criar nosso ambiente de desenvolvimento.\nRecomendamos seguir os seguintes passos:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#1-instalar-o-mongodb-e-o-compass"},"Instalar o MongoDB e o Compass")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#2-iniciar-o-banco-de-dados-e-o-servidor"},"Iniciar o banco de dados e o servidor")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#3-escolher-um-m%C3%B3dulo-cliente"},"Escolher o m\xf3dulo cliente")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#4-definir-esquemas"},"Definir esquemas")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#5-implementar-os-primeiros-todos"},"Implementar as primeiras tarefas (TODOs)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#6-definir-estrat%C3%A9gia-de-testes-unit%C3%A1rios"},"Definir estrat\xe9gia de testes unit\xe1rios")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"#7-familiarizar-se-com-os-testes-de-integra%C3%A7%C3%A3o-e2e"},"Familiarizar-se com os testes de integra\xe7\xe3o (e2e)"))),(0,r.kt)("h2",{id:"1-instalar-o-mongodb-e-o-compass"},"1. Instalar o MongoDB e o Compass"),(0,r.kt)("p",null,"O site do MongoDB possui tutoriais sobre como instalar a ",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/compass/current/install/"},"Community Edition"),".\nEscolha sua plataforma (Windows, Mac, Ubuntu, etc.) e siga ",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/manual/installation/#mongodb-installation-tutorials"},"o tutorial"),"."),(0,r.kt)("p",null,"Nos tutoriais, voc\xea ir\xe1 baixar e instalar o MongoDB em seu sistema,\njuntamente com algumas ferramentas e comandos para usar no terminal."),(0,r.kt)("p",null,"Recomendamos tamb\xe9m que voc\xea instale o ",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/products/compass"},"Compass"),",\nque \xe9 uma GUI (Interface Gr\xe1fica do Usu\xe1rio) para interagir com o banco de dados.\nVoc\xea pode interagir com o MongoDB sem o Compass apenas no terminal, mas uma\nGUI pode ajud\xe1-lo a visualizar e entender o que est\xe1 no banco de dados.\nSiga ",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/compass/current/install/"},"as instru\xe7\xf5es de instala\xe7\xe3o do Compass"),")."),(0,r.kt)("h2",{id:"2-iniciar-o-banco-de-dados-e-o-servidor"},"2. Iniciar o banco de dados e o servidor"),(0,r.kt)("p",null,'Podemos dizer que este projeto possui dois "servi\xe7os":\num \xe9 o banco de dados para armazenar produtos, usu\xe1rios, etc.,\ne o outro \xe9 o servidor para expor a API.'),(0,r.kt)("p",null,"Esses servi\xe7os precisam estar em execu\xe7\xe3o para que a API funcione."),(0,r.kt)("p",null,"Iniciar o servidor \xe9 bastante simples: execute ",(0,r.kt)("inlineCode",{parentName:"p"},"npm start")," para executar\no arquivo ",(0,r.kt)("a",{parentName:"p",href:"../index.js"},(0,r.kt)("inlineCode",{parentName:"a"},"index.js")),", que cont\xe9m a l\xf3gica b\xe1sica de\num servidor com Express."),(0,r.kt)("p",null,"Como iniciar o servidor depende da sua instala\xe7\xe3o e sistema.\nPor exemplo, no macOS, se voc\xea instalou com o homebrew, pode usar o comando\n",(0,r.kt)("inlineCode",{parentName:"p"},"brew services start mongodb-community@6.0")," para inici\xe1-lo.\nOu, sem o homebrew, utilize ",(0,r.kt)("inlineCode",{parentName:"p"},"mongod --config /usr/local/etc/mongod.conf --fork"),".\nNo Windows, \xe9 necess\xe1rio iniciar o servi\xe7o pelo console de servi\xe7os."),(0,r.kt)("p",null,"Consulte o\n",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-os-x/#run-mongodb-community-edition"},"guia de instala\xe7\xe3o para macOS"),",\n",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-windows/#run-mongodb-community-edition-as-a-windows-service"},"guia de instala\xe7\xe3o para Windows"),"\nou a documenta\xe7\xe3o espec\xedfica da sua instala\xe7\xe3o para obter exemplos de como\niniciar o servidor."),(0,r.kt)("h2",{id:"3-escolher-um-m\xf3dulo-cliente"},"3. Escolher um m\xf3dulo (cliente)"),(0,r.kt)("p",null,"Agora que j\xe1 temos um servidor de banco de dados, precisamos escolher\num m\xf3dulo ou biblioteca projetado para interagir com nosso banco de dados\na partir do Node.js. Existem muitas op\xe7\xf5es, mas para este projeto,\nrecomendamos o uso do ",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/drivers/node/current/"},"Node.js driver do MongoDB"),"\nque \xe9 a forma mais direta de interagir com sua inst\xe2ncia do MongoDB."),(0,r.kt)("p",null,"\xc9 necess\xe1rio instalar o Node.js Driver neste projeto usando o ",(0,r.kt)("inlineCode",{parentName:"p"},"npm"),",\n",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/drivers/node/current/quick-start/download-and-install/#install-the-node.js-driver"},"verifique os documentos para mais informa\xe7\xf5es"),"."),(0,r.kt)("p",null,"O ",(0,r.kt)("em",{parentName:"p"},"boilerplate")," j\xe1 inclui um arquivo config.js onde as vari\xe1veis\nde ambiente s\xe3o lidas, e uma delas \xe9 DB_URL. Conforme podemos ver,\nesse valor est\xe1 sendo atribu\xeddo \xe0 propriedade dbUrl do m\xf3dulo config."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// `config.js`\nexports.dbUrl = process.env.MONGO_URL || process.env.DB_URL || 'mongodb://127.0.0.1:27017/test';\n")),(0,r.kt)("p",null,"Agora que sabemos onde encontrar a ",(0,r.kt)("em",{parentName:"p"},"connection string")," (no m\xf3dulo config),\npodemos prosseguir e estabelecer uma conex\xe3o com o banco de dados usando\no cliente escolhido."),(0,r.kt)("h3",{id:"exemplo-de-conex\xe3o-usando-o-driver-do-mongodb-para-nodejs"},"Exemplo de conex\xe3o usando o driver do MongoDB para Node.js"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { MongoClient } = require('mongodb');\nconst config = require(\"./config\");\n\nasync function connect() {\n  try {\n    await client.connect();\n    const db = client.db(<NOMBRE_DB>); // Reemplaza <NOMBRE_DB> por el nombre del db\n    return db;\n  } catch (error) {\n    //\n  }\n}\n")),(0,r.kt)("p",null,"Voc\xea pode encontrar mais exemplos\n",(0,r.kt)("a",{parentName:"p",href:"https://www.mongodb.com/docs/drivers/node/current/"},"na documenta\xe7\xe3o do MongoDB"),"."),(0,r.kt)("h2",{id:"4-definir-esquemas"},"4. Definir esquemas"),(0,r.kt)("p",null,'Como parte do processo de design do nosso banco de dados, precisamos\nespecificar os "esquemas" dos nossos "modelos" de dados. Isso significa\nque precisamos descrever de alguma forma a estrutura das cole\xe7\xf5es que\nvamos usar e a forma dos objetos que vamos armazenar nessas cole\xe7\xf5es.'),(0,r.kt)("p",null,"Voc\xea pode usar ",(0,r.kt)("a",{parentName:"p",href:"https://app.swaggerhub.com/apis-docs/ssinuco/BurgerQueenAPI/2.0.0"},"a documentaci\xf3n de API"),"\nque descreve a estrutura de ",(0,r.kt)("inlineCode",{parentName:"p"},"products"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"orders"),", etc. para orientar o design."),(0,r.kt)("h2",{id:"5-implementar-os-primeiros-todos"},"5. Implementar os primeiros TODOs"),(0,r.kt)("p",null,'O boilerplate do projeto vem com arquivos contendo a l\xf3gica para iniciar o\nservidor e outros que cont\xeam fun\xe7\xf5es de rotas e autentica\xe7\xe3o, mas muitos deles est\xe3o\nvazios. Marcamos as primeiras partes essenciais com coment\xe1rios\n"TODO" (em ingl\xeas, ',(0,r.kt)("inlineCode",{parentName:"p"},"a fazer"),"), que \xe9 uma conven\xe7\xe3o no desenvolvimento de software\npara indicar algo a ser feito."),(0,r.kt)("p",null,"Aqui vamos orient\xe1-lo um pouco sobre esses TODOs."),(0,r.kt)("h3",{id:"todo-1-conectar-a-la-base-de-datos"},"TODO 1: Conectar a la base de datos"),(0,r.kt)("p",null,"No arquivo ",(0,r.kt)("inlineCode",{parentName:"p"},"connect.js"),", \xe9 necess\xe1rio conectar ao banco de dados.."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { dbUrl } = config;\n\nasync function connect() {\n  // TODO: Conex\xe3o com o Banco de Dados\n}\n")),(0,r.kt)("p",null,"Aqui voc\xea deve usar o ",(0,r.kt)("inlineCode",{parentName:"p"},"dbUrl")," que importamos do config para estabelecer a conex\xe3o.\nAs fun\xe7\xf5es que v\xe3o interagir com o banco de dados devem invocar o ",(0,r.kt)("inlineCode",{parentName:"p"},"connect"),"."),(0,r.kt)("h3",{id:"todo-2-criar-o-usu\xe1rio-admin"},"TODO 2: Criar o usu\xe1rio ",(0,r.kt)("em",{parentName:"h3"},"admin")),(0,r.kt)("p",null,"O projeto depende da exist\xeancia de um usu\xe1rio no banco de dados que possui privil\xe9gios\nde administrador, para que seja poss\xedvel criar outros usu\xe1rios, etc."),(0,r.kt)("p",null,"No arquivo ",(0,r.kt)("inlineCode",{parentName:"p"},"routes/users.js"),"  invocamos a fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"initAdminUser(app, next)"),"\nno final do arquivo, e definimos essa fun\xe7\xe3o acima, no mesmo arquivo."),(0,r.kt)("p",null,"A fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"initAdminUser")," est\xe1 incompleta e h\xe1 um TODO para criar o usu\xe1rio admin,\nonde voc\xea precisa primeiro verificar se um admin j\xe1 existe e, caso contr\xe1rio,\nadicion\xe1-lo ao banco de dados."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const initAdminUser = (app, next) => {\n  const { adminEmail, adminPassword } = app.get('config');\n  if (!adminEmail || !adminPassword) {\n    return next();\n  }\n\n  const adminUser = {\n    email: adminEmail,\n    password: bcrypt.hashSync(adminPassword, 10),\n    roles: { admin: true },\n  };\n\n  // TODO: crear usuaria admin\n  next();\n};\n\nVoc\xea pode confirmar se o seu c\xf3digo funciona verificando o banco de\ndados e realizando um teste unit\xe1rio.\n\n")),(0,r.kt)("h3",{id:"todo-3-implementar-autenticaci\xf3n-de-usuario"},"TODO 3: Implementar autenticaci\xf3n de usuario"),(0,r.kt)("p",null,"En routes/auth.js, a rota '/auth' est\xe1 definida com um"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"}," // TODO: autenticar a la usuarix\n")),(0,r.kt)("p",null,"Aqui \xe9 onde voc\xea deve verificar se o email e a senha correspondem aos dados de\nalgum usu\xe1rio no banco de dados. Se coincidirem, \xe9 necess\xe1rio gerar um\n",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io/introduction"},"token JWT"),"\ne envi\xe1-lo na resposta, para que o usu\xe1rio possa us\xe1-lo em suas futuras\nsolicita\xe7\xf5es. Para exemplos mais detalhados, procure tutoriais de autentica\xe7\xe3o\ncom JWT e node/express."),(0,r.kt)("h3",{id:"todo-4-implementar-o-middleware-de-autentica\xe7\xe3o"},"TODO 4: Implementar o middleware de autentica\xe7\xe3o"),(0,r.kt)("p",null,"Em ",(0,r.kt)("inlineCode",{parentName:"p"},"middleware/auth.js"),", existem v\xe1rios TODOs.\nAproveite esta oportunidade para se familiarizar com o\n",(0,r.kt)("a",{parentName:"p",href:"https://expressjs.com/es/guide/using-middleware.html"},"conceito de middleware no express"),"."),(0,r.kt)("p",null,"A aplica\xe7\xe3o usar\xe1 esse middleware para verificar se as solicita\xe7\xf5es que exigem\nautentica\xe7\xe3o s\xe3o autorizadas, ou seja, se possuem um token v\xe1lido."),(0,r.kt)("h3",{id:"todo-5-implementar-a-rota-get-users"},"TODO 5: Implementar a rota GET ",(0,r.kt)("inlineCode",{parentName:"h3"},"/users")),(0,r.kt)("p",null,"Para reunir e verificar todo o trabalho que voc\xea fez, seria bom implementar\numa rota b\xe1sica da API, neste caso, recomendamos ",(0,r.kt)("inlineCode",{parentName:"p"},"/users")," porque voc\xea j\xe1 deve\nter o usu\xe1rio admin em seu banco de dados, e tamb\xe9m porque essa rota usa o\nmiddleware de autentica\xe7\xe3o."),(0,r.kt)("p",null,"Voc\xea ver\xe1 que a rota ",(0,r.kt)("inlineCode",{parentName:"p"},"/users")," usa a fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"getUsers")," que est\xe1 definida\nem ",(0,r.kt)("inlineCode",{parentName:"p"},"controller/users.js"),".\nO conceito de controller \xe9 usado para separar ainda mais a l\xf3gica da\ndefini\xe7\xe3o de rotas da implementa\xe7\xe3o que ir\xe1 interagir com o banco de dados.\n\xc9 necess\xe1rio implementar a fun\xe7\xe3o ",(0,r.kt)("inlineCode",{parentName:"p"},"getUsers")," para obter a lista de\nusu\xe1rios da cole\xe7\xe3o em seu banco de dados."),(0,r.kt)("p",null,"Consulte o ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/routes"},"tutorial de Node.js e express na Mozilla"),"\nque aborda os controllers."),(0,r.kt)("h2",{id:"6-definir-estrat\xe9gia-de-testes-unit\xe1rios"},"6. Definir estrat\xe9gia de testes unit\xe1rios"),(0,r.kt)("p",null,"Al\xe9m dos testes ",(0,r.kt)("inlineCode",{parentName:"p"},"e2e")," j\xe1 inclu\xeddos no boilerplate do projeto, espera-se\nque voc\xea tamb\xe9m possa usar testes unit\xe1rios para o desenvolvimento\ndos diferentes endpoints ou rotas, bem como outros m\xf3dulos internos\nque decidir desenvolver."),(0,r.kt)("p",null,"Para realizar testes unit\xe1rios em ",(0,r.kt)("inlineCode",{parentName:"p"},"rotas")," do Express,\nrecomendamos explorar a biblioteca ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/supertest"},(0,r.kt)("inlineCode",{parentName:"a"},"supertest")),",\n, que pode ser usada em combina\xe7\xe3o com o ",(0,r.kt)("inlineCode",{parentName:"p"},"jest"),"."),(0,r.kt)("p",null,"Outro ponto a ser considerado nos testes unit\xe1rios \xe9 como fazer ",(0,r.kt)("inlineCode",{parentName:"p"},"mock")," do banco\nde dados. Alguns bancos de dados oferecem ferramentas (como o\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nodkz/mongodb-memory-server"},(0,r.kt)("inlineCode",{parentName:"a"},"mongodb-memory-server")),") que nos\npermitem usar um banco de dados em mem\xf3ria e evitar a necessidade de criar ",(0,r.kt)("inlineCode",{parentName:"p"},"mocks"),"\npropriamente ditos. No entanto, geralmente queremos considerar como\nabstrair a intera\xe7\xe3o com o banco de dados para facilitar os ",(0,r.kt)("inlineCode",{parentName:"p"},"mocks")," que nos\npermitir\xe3o focar na l\xf3gica das rotas."),(0,r.kt)("h2",{id:"7-familiarizar-se-com-os-testes-de-integra\xe7\xe3o-e2e"},"7. Familiarizar-se com os testes de integra\xe7\xe3o (e2e)"),(0,r.kt)("p",null,"O ",(0,r.kt)("em",{parentName:"p"},"boilerplate")," deste projeto j\xe1 inclui testes ",(0,r.kt)("inlineCode",{parentName:"p"},"e2e")," (end-to-end) ou\nde integra\xe7\xe3o, que s\xe3o respons\xe1veis por testar nossa aplica\xe7\xe3o como um\ntodo, por meio da interface HTTP. Ao contr\xe1rio dos testes unit\xe1rios,\nem vez de importar ou exigir um m\xf3dulo e testar uma fun\xe7\xe3o isoladamente,\niremos iniciar toda a aplica\xe7\xe3o e test\xe1-la como seria usado no mundo real,\npara isso, a aplica\xe7\xe3o de teste precisar\xe1 de um banco de dados e escutar em\numa porta de rede."),(0,r.kt)("p",null,"Para executar testes ",(0,r.kt)("inlineCode",{parentName:"p"},"e2e")," em uma inst\xe2ncia local, podemos usar:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npm run test:e2e\n")),(0,r.kt)("p",null,"Isso inicia a aplica\xe7\xe3o com npm start e executa os testes contra a\nURL desta inst\xe2ncia (por padr\xe3o, ",(0,r.kt)("inlineCode",{parentName:"p"},"http://127.0.0.1:8080"),")."),(0,r.kt)("p",null,"Os testes e2e dependem do c\xf3digo (",(0,r.kt)("inlineCode",{parentName:"p"},"globalSetup.js"),")","[../e2e/globalSetup.js]","\nque o jest executa primeiro, antes dos testes. Essa etapa de configura\xe7\xe3o\ninicia um banco de dados falso (como mencionamos anteriormente, usando o\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nodkz/mongodb-memory-server"},(0,r.kt)("inlineCode",{parentName:"a"},"mongodb-memory-server")),")\ne o jest se conecta a esse banco de dados falso."),(0,r.kt)("p",null,"Para essa configura\xe7\xe3o, usamos o mongodb-memory-server e um preset\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/shelfio/jest-mongodb"},(0,r.kt)("inlineCode",{parentName:"a"},"jest-mongodb")),"\nque ya est\xe1n incluido en el boilerplate."))}c.isMDXComponent=!0}}]);